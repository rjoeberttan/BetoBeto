FROM node:14.17-alpine
WORKDIR /app
COPY ./package.json ./
RUN npm install
COPY . .

ARG ARG_REACT_APP_DOMAIN
ARG ARG_REACT_APP_KEY_ACCOUNT
ARG ARG_REACT_APP_KEY_GAME
ARG ARG_REACT_APP_KEY_BET
ARG ARG_REACT_APP_KEY_BANK
ARG ARG_REACT_APP_HEADER_WEBSOCKET
ARG ARG_REACT_APP_HEADER_ACCOUNT
ARG ARG_REACT_APP_HEADER_GAME
ARG ARG_REACT_APP_HEADER_BET
ARG ARG_REACT_APP_HEADER_BANK

ENV REACT_APP_DOMAIN=$ARG_REACT_APP_DOMAIN
ENV REACT_APP_KEY_ACCOUNT=$ARG_REACT_APP_KEY_ACCOUNT
ENV REACT_APP_KEY_GAME=$ARG_REACT_APP_KEY_GAME
ENV REACT_APP_KEY_BET=$ARG_REACT_APP_KEY_BET
ENV REACT_APP_KEY_BANK=$ARG_REACT_APP_KEY_BANK
ENV REACT_APP_HEADER_WEBSOCKET=$ARG_REACT_APP_HEADER_WEBSOCKET
ENV REACT_APP_HEADER_ACCOUNT=$ARG_REACT_APP_HEADER_ACCOUNT
ENV REACT_APP_HEADER_GAME=$ARG_REACT_APP_HEADER_GAME
ENV REACT_APP_HEADER_BET=$ARG_REACT_APP_HEADER_BET
ENV REACT_APP_HEADER_BANK=$ARG_REACT_APP_HEADER_BANK

RUN npm run build
RUN npm install -g serve
CMD ["serve", "-s", "build"]